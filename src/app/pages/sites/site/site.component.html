
  <form [formGroup]="siteForm" (ngSubmit)="onSubmit()">
    <!-- Bloque de botones -->
    <div class="d-grid gap-2 d-md-flex justify-content-md-end mb-4 mt-2">
      <h4 class="col"> {{tituloPagina}} <small class="text-muted">(#{{currentSite.id}})</small></h4>  
      <button type="button"  class="btn btn-outline-primary btn-block"
        (click)="abandonarPagina()"> 
        <i class="fas fa-arrow-left"></i>
        Regresar
      </button>
      <!-- Boton guardar formulario-->
      <label class="col-form-label">&nbsp;</label>
      <button type="submit"  class="btn btn-success btn-block">
        Guardar
      </button>
    </div>
    <!-- Fin bloque botones -->
  <!-- Bloque visualizacion datos de local -->
  <div class="row  ms-3 me-3 tablaContenidos">
    <div class="cabeceraVenue">
        <div class="fs-4">Emplazamiento localizado en {{currentVenue.name}} <small class="text-muted">(#{{currentVenue.id}})</small></div>
    </div>
    <div class="row datosVenue">
      <div class="col-3 imagenVenue">
        <img id="fileVenue" class="img-fluid rounded-3"  width="300" [src]="binariosImagenVenue">  
      </div>    
      <div class="col-6">
        <div class="row">
            <div class="col-2">
              <img id="fileVenue" class="img-thumbnail" width="50" [src]="binariosImagenMarca"> 
            </div>            
            <div class="col-4">
              {{currentVenue.brand.description}}
            </div>
            <div class="col-6">
              Región comercial: {{currentVenue.marketRegion.description}}
            </div>
        </div>
        <div class="row mt-3"> <!-- Localización del local-->
          <div class="lead">Localización</div>
          <div>
            Pais: {{currentVenue.country.description}} 
            <table>
              <tbody>
                <tr *ngFor="let a of localizacion">
                  <td>{{a.territorialOrganizationName}}: </td>
                  <td>{{a.territorialEntityName}}</td>
                </tr>
              </tbody>
            </table>
            <div>
              {{currentVenue.roadType.description}}: {{currentVenue.address}} {{currentVenue.streetNumber}}
            </div>
            <div>
              {{currentVenue.postalCode}}
            </div>
          </div>
        </div>      
      </div>    
      <div class="col-3 imagenMap">
        <img id="fileVenue" class="img-fluid rounded-3"  width="300" src="../../../../assets/img/maps.jpeg">  
      </div>      
    </div>
    <!-- Fin segunda linea bloque datos del local-->
  </div>
  <!-- Fin Bloque visualizacion datos de local -->
  <!-- Bloque formulario datos del emplazamiento -->
  <div class="row mt-4">
    <div class="col-4">
      <p class="fs-5">Código de emplazamiento: {{currentSite.siteComercialId}}</p>  
    </div>
    <div class="col-3">
      <p class="fs-5">Estado: {{currentSite.status.description}}</p>  
    </div>
    <div class="col-2">
      <p *ngIf="currentSite.player.license.valid" class="text-success fs-5">{{currentSite.player.license.text}}</p>  
      <p *ngIf="!currentSite.player.license.valid" class="text-danger fs-5"><strong>{{currentSite.player.license.text}}</strong></p>  
    </div>
  </div>
  <!--1 linea -->
  <div class="form-group row mt-2 mb-3">    
    <!-- Localizacion de la pantalla    -->
    <div class="col-4">
      <label class="form-label" for="inputLocalizacionPantalla">Localización de la pantalla</label>
      <select class="form-select" formControlName="localizacionPantalla">
        <option   value="{{a.id}}" *ngFor="let a of screenLocations | notdeletedscreenlocation:localizacionPantallaBorrada" 
                  [selected]="selectLocalizacionPantalla(a.id)" 
                  [class.is-invalid]="localizacionPantallaNoValido">{{a.description}}</option>
      </select>
      <small *ngIf="localizacionPantallaNoValido" class="text-danger">{{msgError('localizacionPantalla')}}</small>
    </div>
    <!-- Fin localización de la pantalla -->
    <!--  Texto pantalla-->
    <div class="col-6">
      <label class="form-label" for="inputTexto">Descripción</label>
      <input class="form-control"
            id="inputTexto"
            type="text"
              formControlName="texto"
            [class.is-invalid]="textoNoValido">
      <small *ngIf="textoNoValido" class="text-danger">{{msgError('texto')}}</small>
    </div>

    <!--  Fin Texto pantalla-->
    <!-- Fecha de alta-->
    <div class="col-2">
      <label class="form-label" for="inputfechaAlta">Fecha de alta</label>
      <p class=" p-2 cajaFecha">{{currentSite.entryDate|date:'mediumDate'}}</p>
      <!-- <input class="form-control"
            id="inputfechaAlta"
            type="text"
            formControlName="fechaAlta"> -->
    </div>
      <!-- Fin fecha de alta -->
  </div>
  <!-- Fin 1 linea -->

  <!--2 linea -->
  <div class="row">
    <!-- Input Imagen del local-->
    <div class="col-4">     
      <label class="form-label" for="inputImagenpantalla">Imagen del pantalla</label>  
      <input (change)="capturarFile($event)"
        class="form-control"
        type="file"
        accept="image/png/jpeg"
        formControlName="imagenPantalla">          
    </div>
    <!-- Fin input imagen del local -->       
    <!-- Imagen del local-->
    <div class="col-3 mt-2">
      <img id="fileSite" class="img-fluid rounded-3"  width="200"  [src]="binariosImagenEmplazamiento">
    </div>
    <!-- Fin Imagen del local-->
   
    <div class="col-4">      <!-- Lista de categorías-->
      <label class="form-label mt-1">Categorías asociadas al emplazamiento</label> 
      <br>
      <table class="table">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col"></th>
            <th scope="col">Descripción</th>
            <th scope="col">Usuario</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let b of categorias">
            <th>
              {{b.id}}
            </th>
            <td>
            <input type="color" [value]="b.color" disabled>
            </td>
            <td>
              {{b.description}}
            </td>
            <td>
              {{b.user}}
            </td>
          </tr>
        </tbody>
      </table>
    </div> <!-- Fin lista de categorías -->
      
  </div>
  <!-- Fin 2 linea -->

  <div>    <!-- Bloque Pestañas de listas de datos de local   -->
    <!-- Titulos de pestañas -->
    <ul class="nav nav-tabs mt-3" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="pantalla-tab" data-bs-toggle="tab" data-bs-target="#pantalla" type="button" role="tab" aria-controls="pantalla" aria-selected="true">Pantalla</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="player-tab" data-bs-toggle="tab" data-bs-target="#player" type="button" role="tab" aria-controls="player" aria-selected="false">Player</button>
      </li>     
    </ul>
    <!-- Fin Titulos pestañas -->

   
    <div class="tab-content" id="myTabContent">   <!-- Contenidos pestañas -->
      <!-- Pestaña pantalla  -->
      <div class="tab-pane fade show active mt-3 " id="pantalla" role="tabpanel" aria-labelledby="pantalla-tab">       
        <div class="row container-fluid">
          <div class="col-6"> <!-- Inicio columna 1 pestaña pantalla-->
            <div class="row">
              <div class="col-3">   <!-- Tipo de pantalla -->
                <label class="form-label" for="inputTipoPantalla">Tipo de pantalla</label>
                <select class="form-select" formControlName="tipoPantalla">
                  <option  value="{{a.id}}" *ngFor="let a of screenTypes" 
                        [selected]="selectTipoPantalla(a.id)" 
                        [class.is-invalid]="tipoPantallaNoValido">{{a.description}}</option>
                </select>
                <small *ngIf="tipoPantallaNoValido" class="text-danger">{{msgError('tipoPantalla')}}</small>
              </div>  <!-- Fin Tipo de pantalla -->              
              <div class="col-4">  <!-- Marca de pantalla -->
                <label class="form-label" for="inputMarcaPantalla">Marca de la pantalla</label>
                <select class="form-select" formControlName="marcaPantalla">
                  <option  value="{{b.id}}" *ngFor="let b of screenBrands" 
                          [selected]="selectMarcaPantalla(b.id)" 
                          [class.is-invalid]="marcaPantallaNoValido">{{b.description}}</option>
                </select>
                <small *ngIf="marcaPantallaNoValido" class="text-danger">{{msgError('marcaPantalla')}}</small>
              </div> <!-- Fin Marca de pantalla -->     
              <div class="col-5">   <!-- Modelo de pantalla -->
                <label class="form-label" for="inputModeloPantalla">Modelo de la pantalla</label>
                <select class="form-select" formControlName="modeloPantalla">
                        this.modeloPantallaSeleccionado.screenBrandId=this.siteForm.get('marcaPantalla').value;
                  <option  value="{{a.id}}" *ngFor="let a of screenModels | modelscreen:tipoPantallaActual:marcaPantallaActual" 
                          [selected]="selectModeloPantalla(a.id)" 
                          [class.is-invalid]="modeloPantallaNoValido">{{a.description}}</option>
                </select>
                <small *ngIf="modeloPantallaNoValido" class="text-danger">{{msgError('modeloPantalla')}}</small>
              </div>  <!-- Fin Modelo de pantalla -->       
            </div>
            <div class="row mt-3">  <!--  Número de modulos del panel-->
              <label class="form-label" for="inputTexto">Número de modulos</label>
              <div class="col-3">
                <input class="form-control"
                      placeholder="Ancho del panel LED"
                      id="inputmodulosAncho"
                      type="number"
                        formControlName="modulosAncho"
                      [class.is-invalid]="modulosAnchoNoValido">
                <small *ngIf="modulosAnchoNoValido" class="text-danger">{{msgError('modulosAncho')}}</small>
              </div>
              <div class="col-3">
                <input class="form-control"
                      placeholder="Alto del panel LED"
                      id="inputmodulosAlto"
                      type="number"
                        formControlName="modulosAlto"
                      [class.is-invalid]="modulosAltoNoValido">
                <small *ngIf="modulosAltoNoValido" class="text-danger">{{msgError('modulosAlto')}}</small>
              </div>              
            </div>  <!--  Fin Número de modulos del panel--> 
            <div class="row mt-3">   
              <div class="col-5"> <!-- Orientación de la pantalla -->
                <label class="form-label" for="inputOrientacionPantalla">Orientación de pantalla</label>
                <select class="form-select" formControlName="orientacionPantalla">
                  <option  value="{{a.id}}" *ngFor="let a of screenOrientations" 
                        [selected]="selectOrientacionPantalla(a.id)" 
                        [class.is-invalid]="orientacionPantallaNoValido">{{a.description}}</option>
                </select>
                <small *ngIf="orientacionPantallaNoValido" class="text-danger">{{msgError('orientacionPantalla')}}</small>
              </div>  <!-- Fin Orientacion  de pantalla -->     
              <div class="col-5">   <!-- Número de serie de la pantalla -->
                <label class="form-label" for="inputNumeroSerie">Número de serie pantalla</label>
                <input class="form-control"
                      id="inputNumeroSeriePantalla"
                      type="text"
                        formControlName="numeroSeriePantalla"
                      [class.is-invalid]="numeroSeriePantallaNoValido">
                <small *ngIf="numeroSeriePantallaNoValido" class="text-danger">{{msgError('numeroSeriePantalla')}}</small>
              </div>  <!-- Fin Número de serie de la pantalla -->
            </div>

          </div> <!-- Fin columna 1 pestaña pantalla -->     
          <div class="col-4 offset-1"> <!-- Inicio columna 2 pestaña pantalla -->
            <div class="row tablaContenidos">
              <div class="cabeceraTabla">
                <div class="fs-5">Características de la pantalla</div>
              </div>
              <div  class="datosTabla">
                <table>
                  <tbody>
                    <tr>
                      <td><strong>Medidas de la Pantalla (mm):</strong></td>
                      <td>{{anchoPantalla}} <span *ngIf="anchoPantalla>0"> x </span> {{altoPantalla}}</td>
                    </tr>
                    <tr>
                      <td><strong>Resolución de la Pantalla:</strong></td>
                      <td>{{resolucionAncho}} <span *ngIf="resolucionAncho>0"> x </span> {{resolucionAlto}}</td>
                    </tr>
                    <tr>
                      <td><strong>Pulgadas:</strong></td>
                      <td>{{pulgadasPantalla}}</td>
                    </tr>
                    <tr>
                      <td><strong>Pixel:</strong></td>
                      <td>{{pixelesPantalla}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div> <!-- Fin columna 2 pestaña pantalla-->
       </div>
       <div class="row mt-3">
        <div class="col-12"> <!-- Observaciones de la pantalla -->
          <label class="form-label" for="inputObservaciones">Observaciones</label>
          <input class="form-control"
                id="inputObservaciones"
                type="text"
                  formControlName="observaciones"
                [class.is-invalid]="observacionesNoValido">
          <small *ngIf="observacionesNoValido" class="text-danger">{{msgError('observaciones')}}</small>
        </div>  <!-- Fin Observaciones  de pantalla -->     
       </div>  
      </div>
      <!-- Fin Pestaña pantalla  -->

      <!-- Inicio Pestaña player  -->
      <div class="tab-pane fade mt-3" id="player" role="tabpanel" aria-labelledby="player-tab">  
        <div class="row container-fluid">   
          <div class=col-3>     <!--  Número de serie del player -->
            <label class="form-label" for="inputNumeroSeriePlayer">Número de serie reproductor</label>
            <input class="form-control"
            id="inputnumeroSeriePlayer"
            type="text"
            formControlName="numeroSerieReproductor"
            [class.is-invalid]="numeroSerieReproductorNoValido">
            <small *ngIf="numeroSerieReproductorNoValido" class="text-danger">{{msgError('numeroSerieReproductor')}}</small>
          </div>                <!-- Fin Número de serie del player -->
          <div class=col-3>       <!-- Orientación de la player -->
            <label class="form-label" for="inputOrientacionPlayer">Orientación del reproductor</label>
            <select class="form-select" 
            formControlName="orientacionReproductor">
            <option  value="{{a.id}}" *ngFor="let a of screenOrientations" 
            [selected]="selectOrientacionReproductor(a.id)" 
            [class.is-invalid]="orientacionReproductorNoValido">{{a.description}}</option>
            </select>
            <small *ngIf="orientacionReproductorNoValido" class="text-danger">{{msgError('orientacionReproductor')}}</small>
          </div>  <!-- Fin Orientacion  de player -->  
          <div class="col-4 offset-1">
            <div class="row tablaContenidos">  
              <div class="cabeceraTabla">
                <div class="fs-5">Información del reproductor</div>
              </div>
              <div  class="datosTabla">
                <table>
                  <tbody>
                    <tr>
                      <td><strong>IDPTI:</strong></td>
                      <td>{{currentSite.idpti}}</td>
                    </tr>
                    <tr>
                      <td><strong>MAC:</strong></td>
                      <td>{{currentSite.player.mac}}</td>
                    </tr>
                    <tr>
                      <td><strong>Versión del sistema operativo:</strong></td>
                      <td>{{currentSite.player.osVersion}}</td>
                    </tr>
                    <tr>
                      <td><strong>Versión aplicación instalada:</strong></td>
                      <td>{{currentSite.player.appVersion}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <div class="row ms-2">
                  <div class="col-4"> 
                    <div class="row tablaContenidos">  
                      <div class="cabeceraTabla">
                        <div class="fs-5">Licencia de uso</div>
                      </div>
                      <div  class="datosTabla">
                        <table>
                          <tbody>
                            <tr>
                              <td *ngIf="currentSite.player.license.valid" class="text-success fs-5"><strong>Licencia activa</strong></td>
                              <td *ngIf="!currentSite.player.license.valid" class="text-danger fs-5"><strong>Licencia expirada</strong></td>
                            </tr>
                            <tr>
                              <td><strong>Número de licencia:</strong></td>
                              <td>{{currentSite.player.license.licenseNumber}}</td>  
                            </tr>
                            <tr>
                              <td><strong>Fecha de activación:</strong></td>
                              <td>{{currentSite.player.license.activationDate|date:'longDate'}}</td>
                            </tr>         
                            <tr>
                              <td><strong>Fecha de expiración:</strong></td>
                              <td>{{currentSite.player.license.expirationDate|date:'longDate'}}</td>            
                            </tr>            
                            <tr>
                              <td><strong>Meses de duración:</strong></td>
                              <td>{{currentSite.player.license.durationMonths}}</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
        </div>
      </div>

      <!-- Fin Pestaña player  -->

    </div>    <!-- Fin Contenidos pestañas -->
  
  </div>   <!-- Fin bloque Pestañas de listas de datos de cliente    -->          
</form>



<pre>
  estado formulario:{{siteForm.valid}}
  <br>
  status:{{siteForm.status}}
  touched:{{siteForm.touched}}
</pre>


<pre>
  {{siteForm.value|json}}
</pre>